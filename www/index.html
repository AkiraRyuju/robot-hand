<html>

<head>

	<style>
		div#buttons > div {
			display: inline-block;
		}
			div#buttons > div a {
				background-color: lightgray;
				padding:20px;
			} 
	</style>

	<script>
		function ajaxRequest(request_url) {
			var xhttp = new XMLHttpRequest();
			xhttp.onreadystatechange = function () {
				if (this.readyState == 4 && this.status == 200) {
					var messageObject = JSON.parse(this.response); //converts to JSON
					updateStatus(messageObject.message);
					//passes along just the message component of the JSON request
				} 
			};
			xhttp.open("GET", request_url, true);
			xhttp.send();
		}

		function updateStatus(message) {
			document.getElementById('status').innerHTML = message;
			//Puts status message onto home page
		}

		function fingerGoto() {
			var angle = document.getElementById('gotoAngle').value;
			ajaxRequest('/api/goto?angle=' + angle);
		}
		function fingerCalibrate(){
			alert('ASS');
			var minOff = document.getElementById('minOffset').value;
			var maxOff = document.getElementById('maxOffset').value;
			if(minOff.length < 3){
				minOff = `0${minOff}`;
			}
			if(maxOff.length < 3){
				minOff = `0${maxOff}`;
			}
			if(minOff.length != 3 || maxOff.length != 3){
				minOff = '000';
				maxOff = '000';
			}
			ajaxRequest(`/api/calibrate/min${minOff}/max${maxOff}`);
		}

		function sendInstruction(action) {
			switch (action) {
				case 'blink-test':
					ajaxRequest('/api/blink-test');
					break;
				case 'finger-open':
					ajaxRequest('/api/open');
					break;
				case 'finger-close':
					ajaxRequest('/api/close');
					break;
				case 'finger-goto':
					fingerGoto();
					break;
				case 'finger-calibrate':
					fingerCalibrate();
					break;
			}
		}

	</script>
</head>

<body>
	<h1>Status: <span id="status">Ready</span></h1>
	<div id="buttons">
		<div>
			<!--<a href="javascript:void(0);" onclick="sendInstruction('blink-test');">Blink Test</a>-->
		</div>
		<div>
			<a href="javascript:void(0);" onclick="sendInstruction('finger-open');">Open Finger</a>
		</div>
		<div>
			<a href="javascript:void(0);" onclick="sendInstruction('finger-close');">Close Finger</a>
		</div>
		<div>
			<a href="javascript:void(0);" onclick="sendInstruction('finger-goto');">Go to </a>
			<input id="gotoAngle" type="text">
		</div>
		<div>
			<a href="javascript:void(0);" onclick="sendInstruction('finger-calibrate');">Set Callibrations </a>
			Minimum <input id="minOffset" type="text">
			Maximum <input id="maxOffset" type="text">
		</div>
	</div>
</body>

</html>